---
name: Functional Tests

on:
  pull_request:
    types: [opened]

jobs:
  test-reviewers-file:
    name: Test REVIEWERS file
    if: ${{ startsWith(github.event.pull_request.title, '[automation]') }}
    timeout-minutes: 5
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ${{ github.repository }}
        uses: actions/checkout@v4
      - name: Generate GitHub token
        id: app-token
        uses: actions/create-github-app-token@v1
        with:
          app-id: ${{ vars.APP_PR_ACCESS_ID }}
          private-key: ${{ secrets.APP_PR_ACCESS_PRIVATE_KEY }}
      - name: Assign reviewers
        uses: ./
        with:
          github-token: ${{ steps.app-token.outputs.token }}
      - name: Close PR
        uses: superbrothers/close-pull-request@v3
        with:
          github_token: ${{ steps.app-token.outputs.token }}
